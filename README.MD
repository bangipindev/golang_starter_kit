# GPT Auth Service

Production-ready REST API menggunakan:

- Golang
- Fiber v2
- MySQL
- JWT Authentication
- Clean Architecture
- Goose Migration
- Docker Support

---

# ğŸ“¦ Project Structure
```
	cmd/
	â””â”€â”€ server/
		â””â”€â”€ main.go

	config/
	â””â”€â”€ config.go

	internal/
	â”œâ”€â”€ delivery/
	â”‚ â””â”€â”€ http/
	â”‚ â”œâ”€â”€ dto/
	â”‚ â”œâ”€â”€ handler/
	â”‚ â””â”€â”€ routes.go
	â”‚
	â”œâ”€â”€ domain/
	â”‚ â””â”€â”€ user.go
	â”‚
	â”œâ”€â”€ infrastructure/
	â”‚ â”œâ”€â”€ repository/
	â”‚ â”œâ”€â”€ database.go
	â”‚ â””â”€â”€ migrate.go
	â”‚
	â”œâ”€â”€ middleware/
	â”‚ â””â”€â”€ jwt_middleware.go
	â”‚
	â”œâ”€â”€ pkg/
	â”‚ â””â”€â”€ response/
	â”‚
	â”œâ”€â”€ usecase/
	â”‚ â””â”€â”€ auth.go
	â”‚
	â””â”€â”€ utils/

	migrations/
	â””â”€â”€ 001_create_user.sql

	.env
	docker-compose.yml
	Dockerfile
	go.mod
	README.md

```



---

# ğŸ§  Architecture Overview
```
	Project ini menggunakan Clean Architecture:

	HTTP (Fiber)
	â†“
	Handler (Delivery Layer)
	â†“
	Usecase (Business Logic)
	â†“
	Domain (Interface + Entity)
	â†“
	Infrastructure (DB, Repository, Migration)
```


## ğŸ“Œ Layer Explanation

### 1ï¸âƒ£ delivery/http
Berisi:
- DTO (request/response struct)
- Handler (controller)
- Route definition

Tidak boleh berisi business logic.

---

### 2ï¸âƒ£ domain
Berisi:
- Entity (User struct)
- Interface repository

Pure business model.
Tidak boleh import Fiber / MySQL.

---

### 3ï¸âƒ£ usecase ( Bisa juga disebut Layer Service)
Berisi:
- Business logic
- Auth logic
- JWT creation
- Password hashing

Tidak tahu HTTP.
Hanya tahu interface repository.

---

### 4ï¸âƒ£ infrastructure
Berisi:
- Database connection
- Repository implementation ( Penulisan Query Ada Disini)
- Migration runner

Layer ini implementasi teknis.

---

### 5ï¸âƒ£ middleware
JWT middleware untuk proteksi endpoint.

---

### 6ï¸âƒ£ pkg/response
Standard API response wrapper agar konsisten.

---

# ğŸš€ Features

- Register
- Login
- JWT Authentication
- Protected Route
- Auto Migration
- Standard JSON Response
- Environment Based Config
- APP_MODE (dev / prod)

---

# âš™ï¸ Environment Setup

Buat file `.env`:

```
	DB_HOST=localhost
	DB_PORT=3306
	DB_USER=root
	DB_PASS=password
	DB_NAME=gpt_db

	JWT_SECRET=supersecretkey

	APP_PORT=8080
	APP_MODE=dev

```

### INSTALL AIR 
```
go install github.com/air-verse/air@latest

```
---

# â–¶ï¸ Run Without Docker

1ï¸âƒ£ Install dependencies

```
go mod tidy

```

Copy env.example to .env

```
 Copy env.example to .env

```


2ï¸âƒ£ Pastikan MySQL jalan

3ï¸âƒ£ Jalankan app

Manual Run

```
go run cmd/server/main.go

```

Hot Reload / Automatic Run

```
air

```

---

# ğŸ³ Run With Docker

```
docker-compose up --build

```


---

# ğŸ—„ Migration

Migration menggunakan Goose.

File migration ada di:

```
migrations/001_create_user.sql

```


Auto run migration saat startup:

```
infrastructure.RunMigration(db)

```


Manual run:

```
goose -dir migrations mysql "user:pass@tcp(localhost:3306)/gpt_db" up

```



---

# ğŸ” API Endpoints

## Register

POST `/api/v1/auth/register`

```
	{
		"name": "Ervin",
		"email": "ervin@mail.com",
		"password": "123456"
	}
```


---

## Login

POST `/api/v1/auth/login`

Response:

```
	{
		"success": true,
		"data": {
			"token": "JWT_TOKEN"
		}
	}
```


---

## Profile (Protected)

GET `/api/v1/profile`

Header:


```
	Authorization: Bearer JWT_TOKEN

```


---

# ğŸ— Clean Architecture Rules

âœ” Domain tidak boleh import Fiber
âœ” Usecase tidak boleh import database
âœ” Handler tidak boleh akses database langsung
âœ” Repository implementasi ada di infrastructure
âœ” Semua dependency di inject dari main.go

---
### FULL FLOW VISUAL
```
	Client
	â†“
	Fiber Router
	â†“
	Handler (delivery/http)
	â†“
	Usecase (business logic)
	â†“
	Domain (interface)
	â†“
	Repository (infrastructure)
	â†“
	Database (MySQL)
	â†‘
	Repository return result
	â†‘
	Usecase process
	â†‘
	Handler format response
	â†‘
	Client menerima JSON

```
---

### ğŸ” FLOW PROTECTED ROUTE (JWT)
```
	Client
	â†“
	JWT Middleware
	â†“ (valid token?)
	Handler.Profile
	â†“
	Usecase.GetProfile
	â†“
	Repository.FindByID
	â†“
	Database
	â†‘
	Return user data
	â†‘
	Response JSON


```

Jika token invalid:

```
	Middleware stop
	Return 401

```
---

### ğŸ“Š Versi Diagram Arsitektur Clean (Conceptual)

```
	â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
	â”‚      DELIVERY      â”‚
	â”‚  (Fiber, Handler)  â”‚
	â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
			  â†“
	â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
	â”‚      USECASE       â”‚
	â”‚  (Auth Service)    â”‚
	â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
			  â†“
	â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
	â”‚       DOMAIN       â”‚
	â”‚ Entity + Interface â”‚
	â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
			  â†“
	â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
	â”‚   INFRASTRUCTURE   â”‚
	â”‚   DB + Repository  â”‚
	â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```
---

# ğŸ“ˆ Production Ready Improvements

- Add refresh token
- Add structured logging (zap)
- Add request ID middleware
- Add validation (go-playground/validator)
- Add rate limiter
- Add role based access
- Add Swagger docs
- Add unit test
- Add CI/CD pipeline

---

# ğŸ‘¨â€ğŸ’» Author

Ervin Santoso
Backend Developer


